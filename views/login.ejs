<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width='device-width', initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Login Page</title>
    <link rel="stylesheet" href="/stylesheets/layout.css" />
  </head>
  <body>
    <div class="container">
      <div class="login-container">
        <form action="" id="frmLogin">
          <label for="username" class="form-inline label">Username</label>
          <input type="text" name="username" class="form-inline" />
          <label for="password" class="form-inline label">Password</label>
          <input type="password" name="password" class="form-inline" />
          <div class="submit-buttton">
            <input type="submit" class="form-submit" value="Login" id="btn-login" />
          </div>
        </form>
      </div>
    </div>
  </body>

  <script src="/javascripts/networkInterceptor/utils/errorHandlers.js"></script>
  <script src="/javascripts/networkInterceptor/utils/index.js"></script>
  <script src="/javascripts/networkInterceptor/manage/base.js"></script>
  <script src="/javascripts/networkInterceptor/manage/get.js"></script>
  <script src="/javascripts/networkInterceptor/manage/post.js"></script>
  <script src="/javascripts/networkInterceptor/manage/put.js"></script>
  <script src="/javascripts/networkInterceptor/manage/delete.js"></script>
  <script src="/javascripts/networkInterceptor/index.js"></script>

  <script>
    const page = {
      login: async () => {
        let username = document.querySelector('[name = "username"]').value;
        let password = document.querySelector('[name = "password"]').value;
        let data = { username, password };
        let request = new NetworkInterceptor({
          method: "post",
          url: "login_process",
          data,
          onSuccess: response => {
            if (response.token) {
              window.location.replace("/");
            }
          }
        });
        let dataasd = await request.createRequest();
      }
    };
    let submitButton = document.getElementById("btn-login");
    submitButton.onclick = e => {
      e.preventDefault();
      page.login();
    };
  </script>
</html>
